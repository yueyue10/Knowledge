<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>画布练习</title>
  <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
  <style>
    @font-face {
      font-family: "iconfont";
      src: url('iconfont.eot?t=1608886077133'); /* IE9 */
      src: url('iconfont.eot?t=1608886077133#iefix') format('embedded-opentype'), /* IE6-IE8 */ url('data:application/x-font-woff2;charset=utf-8;base64,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') format('woff2'),
      url('iconfont.woff?t=1608886077133') format('woff'),
      url('iconfont.ttf?t=1608886077133') format('truetype'), /* chrome, firefox, opera, Safari, Android, iOS 4.2+ */ url('iconfont.svg?t=1608886077133#iconfont') format('svg'); /* iOS 4.1- */
    }

    .iconfont {
      font-family: "iconfont" !important;
      font-size: 16px;
      font-style: normal;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
  </style>
</head>
<body>
<div>画布练习</div>
<span id="unselect" class="iconfont" style="display: none">&#xe6f1;</span>
<span id="selected" class="iconfont" style="display: none">&#xe6f8;</span>
<canvas id="canvas" width="1000px" height="700px" style="background: #879997"></canvas>
<script type="application/javascript">
  // debugger

  let winWidth = 1000;
  let winHeight = 700;
  let seatWidth = winWidth / 80;
  let unselectText = document.getElementById("unselect").textContent;
  let selectedText = document.getElementById("selected").textContent;
  console.log("window", window.innerWidth, window.innerHeight)
  let canvas = document.getElementById("canvas");
  let selectPoint = null
  // 监听点击事件
  canvas.addEventListener(
    "click",
    function (e) {
      let x = e.clientX - canvas.getBoundingClientRect().left;
      let y = e.clientY - canvas.getBoundingClientRect().top;
      console.info("addEventListener", x, y);
      selectPoint = {x, y}
      drawSeat()
    },
    false
  );
  // 开始绘制
  setTimeout(() => {
    drawSeat()
  }, 1000)

  function drawSeat() {
    var canvas = document.getElementById("canvas");
    var ctx = canvas.getContext("2d");
    if (canvas.getContext("2d")) {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      drawFloor(ctx)
      for (let i = 0; i < 25; i++) {
        for (let j = 0; j < 10; j++) {
          drawSeat(ctx, 70 + 30 * i, 80 + 50 * j)
        }
      }
    }

    function drawFloor(ctx) {
      // 绘制楼层
      ctx.beginPath();
      ctx.strokeStyle = "#CBCBCD";
      ctx.fillStyle = "#fff";
      ctx.rect(30, 30, winWidth - 60, winHeight - 60);
      ctx.fillRect(50, 50, winWidth - 100, winHeight - 100);
      // 楼层文字
      ctx.font = "80px";
      ctx.fillStyle = "#838388";
      ctx.fillText("一层", winWidth / 2, winHeight / 2);
      ctx.stroke();
    }

    function drawSeat(ctx, seatX, seatY) {
      if (selectPoint != null) {
        ctx.beginPath();
        ctx.rect(seatX, seatY, seatWidth + 50, seatWidth + 50);
        // debugger
        if (ctx.isPointInPath(selectPoint.x, selectPoint.y)) {
          console.log("selectPoint", selectPoint.x, selectPoint.y)
          ctx.fillStyle = "#1F8707";
          ctx.font = seatWidth + "px iconfont";
          ctx.fillText(selectedText, seatX, seatY);
        } else {
          ctx.fillStyle = "#1F8707";
          ctx.font = seatWidth + "px iconfont";
          ctx.fillText(unselectText, seatX, seatY);
        }
      } else {
        ctx.fillStyle = "#1F8707";
        ctx.font = seatWidth + "px iconfont";
        ctx.fillText(unselectText, seatX, seatY);
      }
    }
  }
</script>
</body>
</html>
